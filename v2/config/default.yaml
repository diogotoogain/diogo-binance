# ═══════════════════════════════════════════════════════════════
# V2 TRADING BOT - DEFAULT CONFIGURATION
# ═══════════════════════════════════════════════════════════════
# REGRA: NENHUM NÚMERO HARDCODED - Todos os parâmetros vêm daqui!
# V2 DEFAULT CONFIGURATION
# Todos os parâmetros são configuráveis - ZERO hardcoded
# All parameters are configurable - NO HARDCODED VALUES
# ═══════════════════════════════════════════════════════════════

# ═══════════════════════════════════════════════════════════════
# MARKET
# ═══════════════════════════════════════════════════════════════
market:
  exchange: "binance_testnet"
  symbol: "BTCUSDT"
  base_timeframes: ["1s", "1m", "5m", "15m", "1h"]

# ═══════════════════════════════════════════════════════════════
# RISK MANAGEMENT
# ═══════════════════════════════════════════════════════════════
risk:
  # Risk per trade - OPTIMIZE: [0.25, 0.5, 1.0, 1.5, 2.0]
  risk_per_trade_pct: 1.0
  
  # Max position size as % of balance - OPTIMIZE: [2, 5, 10, 15, 20]
  max_position_size_pct: 5.0
  
  # Daily loss limit - OPTIMIZE: [2, 3, 5, 7]
  max_daily_loss_pct: 3.0
  
  # Maximum trades per day - OPTIMIZE: [20, 50, 100]
  max_daily_trades: 50
  
  # Weekly loss limit - OPTIMIZE: [5, 7, 10, 15]
  max_weekly_loss_pct: 7.0
  
  # Monthly loss limit - OPTIMIZE: [10, 15, 20, 25]
  max_monthly_loss_pct: 15.0
  
  # Maximum drawdown - OPTIMIZE: [10, 15, 20, 25, 30]
  max_drawdown_pct: 20.0
  
  # Max concurrent positions - OPTIMIZE: [1, 2, 3, 5]
  max_concurrent_positions: 1
  
  # Max leverage - OPTIMIZE: [3, 5, 10, 15, 20]
  max_leverage: 10

  # ═════════════════════════════════════════════════════════════
  # KILL SWITCH - CRÍTICO! NUNCA DESATIVAR!
  # ═════════════════════════════════════════════════════════════
  kill_switch:
    # ⚠️ SEMPRE TRUE - Se tentar desativar, sistema lança exceção!
    enabled: true
    # Trigger loss % - OPTIMIZE: [3, 5, 7, 10]
    trigger_loss_pct: 5.0
    # Pause hours after trigger - OPTIMIZE: [12, 24, 48]
    pause_hours: 24

  # ═════════════════════════════════════════════════════════════
  # REGIME ADJUSTMENT
  # ═════════════════════════════════════════════════════════════
  regime_adjustment:
    enabled: true
    # Multiplier during crash/extreme volatility - OPTIMIZE: [0.1, 0.2, 0.3, 0.5]
    crash_multiplier: 0.3
    # Multiplier during high volatility - OPTIMIZE: [0.3, 0.5, 0.7]
    high_vol_multiplier: 0.5

# ═══════════════════════════════════════════════════════════════
# BET SIZING
# ═══════════════════════════════════════════════════════════════
bet_sizing:
  # Method - TOGGLE: [fixed, kelly, vol_target, rl]
  method: "kelly"
  
  # Fixed size configuration
  fixed:
    # Size % - OPTIMIZE: [1, 2, 3, 5]
    size_pct: 2.0
  
  # Kelly criterion configuration
  kelly:
    # Fraction of Kelly - OPTIMIZE: [0.1, 0.25, 0.5, 0.75]
    fraction: 0.25
    # Max size % - OPTIMIZE: [5, 10, 15, 20]
    max_size_pct: 10.0
  
  # Volatility targeting configuration
  vol_target:
    # Target annual volatility - OPTIMIZE: [0.10, 0.15, 0.20, 0.25]
    annual_vol: 0.15
    # Base size percentage - OPTIMIZE: [1, 2, 3, 5]
    base_size_pct: 2.0
    # Max size percentage - OPTIMIZE: [5, 10, 15, 20]
    max_size_pct: 10.0

# ═══════════════════════════════════════════════════════════════
# POSITION MANAGEMENT
# ═══════════════════════════════════════════════════════════════
position:
  # Stop Loss type - TOGGLE: [fixed_pct, atr, volatility]
  sl_type: "atr"
  # Fixed SL % - OPTIMIZE: [0.5, 1.0, 1.5, 2.0, 3.0]
  sl_fixed_pct: 1.0
  # ATR multiplier for SL - OPTIMIZE: [0.5, 1.0, 1.5, 2.0, 3.0]
  sl_atr_multiplier: 1.5
  
  # Take Profit type - TOGGLE: [fixed_pct, atr, rr_ratio]
  tp_type: "atr"
  # Fixed TP % - OPTIMIZE: [1.0, 1.5, 2.0, 3.0, 5.0]
  tp_fixed_pct: 2.0
  # ATR multiplier for TP - OPTIMIZE: [1.0, 1.5, 2.0, 2.5, 3.0, 5.0]
  tp_atr_multiplier: 2.5
  # Risk:Reward ratio for TP - OPTIMIZE: [1.5, 2.0, 2.5, 3.0]
  tp_rr_ratio: 2.0
  
  # Trailing Stop configuration
  trailing_stop:
    # Enable trailing stop - TOGGLE
    enabled: true
    # Type - TOGGLE: [fixed_pct, atr]
    type: "atr"
    # Activation threshold % - OPTIMIZE: [0.5, 1.0, 1.5, 2.0]
    activation_pct: 1.0
    # Trail % - OPTIMIZE: [0.3, 0.5, 0.75, 1.0]
    trail_pct: 0.5
    # ATR multiplier for trailing - OPTIMIZE: [0.5, 1.0, 1.5, 2.0]
    trail_atr_mult: 1.0
# FEATURES
# LABELING
# ═══════════════════════════════════════════════════════════════
labeling:
  triple_barrier:
    enabled: true
    tp_multiplier: 2.0       # OPTIMIZE: [1.0, 1.5, 2.0, 2.5, 3.0]
    sl_multiplier: 1.0       # OPTIMIZE: [0.5, 1.0, 1.5, 2.0]
    max_holding_bars: 100    # OPTIMIZE: [50, 100, 200, 500]
  meta_labeling:
    enabled: true
    model_type: "xgboost"    # TOGGLE: [xgboost, lightgbm, random_forest]
    confidence_threshold: 0.6  # OPTIMIZE: [0.5, 0.55, 0.6, 0.65, 0.7]
# All parameters are optimizable - NO HARDCODED VALUES
# ═══════════════════════════════════════════════════════════════

# ═══════════════════════════════════════════════════════════════
# FEATURES - ALL PARAMETERS OPTIMIZABLE
# ═══════════════════════════════════════════════════════════════
features:
  microstructure:
    enabled: true
    ofi:
      enabled: true
      window: 20
    tfi:
      enabled: true
      window: 20
      window: 20  # OPTIMIZE: [5, 10, 20, 50, 100]
    tfi:
      enabled: true
      window: 20  # OPTIMIZE: [5, 10, 20, 50, 100]
    micro_price:
      enabled: true
    entropy:
      enabled: true
      window: 50  # OPTIMIZE: [20, 50, 100, 200]
    vpin:
      enabled: true
      n_buckets: 50  # OPTIMIZE: [20, 50, 100]
      bucket_size_usd: 100000

  technical:
    enabled: true
    ema:
      periods: [9, 21, 50, 100, 200]
    rsi:
      enabled: true
      period: 14
      overbought: 70
      oversold: 30
    adx:
      enabled: true
      period: 14
    bollinger:
      enabled: true
      period: 20
      std_dev: 2.0
    atr:
      enabled: true
      period: 14

# ═══════════════════════════════════════════════════════════════
# STRATEGIES
# ═══════════════════════════════════════════════════════════════
strategies:
  hft_ofi_scalper:
    enabled: true
    params:
      ofi_threshold: 0.3              # OPTIMIZE: [0.1-0.5]
      tfi_threshold: 0.3
      min_spread_bps: 1.0
      holding_seconds: 30             # OPTIMIZE: [10-300]
    filters:
      adx_filter:
        enabled: true
        max_adx: 30
      volume_spike_filter:
        enabled: true
        min_spike_multiplier: 1.5
    throttling:
      enabled: true
      max_trades_per_minute: 5
      cooldown_after_loss_seconds: 30

  momentum_intraday:
    enabled: true
    params:
      ema_fast: 9                     # OPTIMIZE: [5-15]
      ema_slow: 21                    # OPTIMIZE: [15-50]
      rsi_entry_threshold: 50
      holding_minutes: 60
    filters:
      adx_filter:
        enabled: true
        min_adx: 25
      volume_confirmation:
        enabled: true
        min_volume_percentile: 60
    throttling:
      enabled: true
      max_trades_per_hour: 4

  mean_reversion_intraday:
    enabled: true
    params:
      zscore_entry: 2.0               # OPTIMIZE: [1.5-3.0]
      zscore_exit: 0.5
      bollinger_entry_std: 2.0
      holding_minutes: 30
    filters:
      adx_filter:
        enabled: true
        max_adx: 20
      liquidity_cluster_filter:
        enabled: true
        proximity_threshold_pct: 0.5
    throttling:
      enabled: true
      max_trades_per_hour: 6

  volatility_breakout:
    enabled: true
    params:
      squeeze_bb_width_percentile: 20
      breakout_atr_mult: 1.5          # OPTIMIZE: [1.0-2.5]
      volume_confirm_mult: 1.5
      holding_minutes: 120
    filters:
      adx_filter:
        enabled: true
        min_adx_after_breakout: 20
    throttling:
      enabled: true
      max_trades_per_day: 3

# ═══════════════════════════════════════════════════════════════
# ENSEMBLE
# ═══════════════════════════════════════════════════════════════
ensemble:
  weighting_method: "sharpe"          # Options: sharpe, sortino, kelly, equal
  lookback_days: 30
  min_confidence: 0.5
  rebalance_frequency_hours: 24
  strategy_constraints:
    max_weight_per_strategy: 0.6
    min_weight_per_strategy: 0.0
  disable_strategy_if:
    max_drawdown_pct: 15.0
    min_sharpe: 0.5

# ═══════════════════════════════════════════════════════════════
# RISK MANAGEMENT
# ═══════════════════════════════════════════════════════════════
risk_management:
  max_risk_per_trade_pct: 0.5
  max_daily_loss_pct: 3.0
  max_weekly_loss_pct: 7.0
  max_monthly_loss_pct: 15.0
  max_drawdown_pct: 20.0
  max_open_positions: 1
  max_leverage: 10
      enabled: true
      periods: [9, 21, 50, 100, 200]  # OPTIMIZE: multiple period combinations
    rsi:
      enabled: true
      period: 14  # OPTIMIZE: [7, 14, 21, 28]
      overbought: 70  # OPTIMIZE: [65, 70, 75, 80]
      oversold: 30  # OPTIMIZE: [20, 25, 30, 35]
    macd:
      enabled: true
      fast: 12  # OPTIMIZE: [8, 12, 16]
      slow: 26  # OPTIMIZE: [20, 26, 30]
      signal: 9  # OPTIMIZE: [6, 9, 12]
    adx:
      enabled: true
      period: 14  # OPTIMIZE: [7, 14, 21, 28]
      trending_threshold: 25  # OPTIMIZE: [20, 25, 30, 35]
      ranging_threshold: 20  # OPTIMIZE: [15, 18, 20]
    bollinger:
      enabled: true
      period: 20  # OPTIMIZE: [10, 20, 30]
      std_dev: 2.0  # OPTIMIZE: [1.5, 2.0, 2.5, 3.0]
    atr:
      enabled: true
      period: 14  # OPTIMIZE: [7, 14, 21, 28]

  volume_analysis:
    enabled: true
    volume_spike:
      enabled: true
      lookback: 20  # OPTIMIZE: [10, 20, 30, 50]
      threshold_multiplier: 2.0  # OPTIMIZE: [1.5, 2.0, 2.5, 3.0]
    liquidity_clusters:
      enabled: true
      levels: 10  # OPTIMIZE: [5, 10, 15, 20]
      threshold_percentile: 80  # OPTIMIZE: [70, 80, 90]
      recalc_frequency: 100  # OPTIMIZE: [50, 100, 200]
      cluster_threshold_pct: 0.1  # OPTIMIZE: [0.05, 0.1, 0.2]

# ═══════════════════════════════════════════════════════════════
# REGIME DETECTION
# ═══════════════════════════════════════════════════════════════
regime:
  hmm:
    enabled: true
    n_regimes: 3             # OPTIMIZE: [2, 3, 4]
    features: ["returns", "volatility", "volume"]
    covariance_type: "full"  # Options: spherical, diag, full, tied
    n_iter: 100              # Max iterations for fitting
    random_state: 42
  adx_based:
    enabled: true
    trending_threshold: 25   # OPTIMIZE: [20, 25, 30]
    ranging_threshold: 20    # OPTIMIZE: [15, 18, 20]
  volatility:
    enabled: true
    lookback: 100            # Lookback period for percentile calculation
    low_percentile: 25       # Below this = low volatility
    high_percentile: 75      # Above this = high volatility
    extreme_percentile: 95   # Above this = extreme volatility

# ═══════════════════════════════════════════════════════════════
# REGIME RISK ADJUSTMENT
# ═══════════════════════════════════════════════════════════════
risk_adjustment:
  favorable_multiplier: 1.0
  neutral_multiplier: 0.7
  unfavorable_multiplier: 0.3

# ═══════════════════════════════════════════════════════════════
# STRATEGY WEIGHTS BY REGIME
# ═══════════════════════════════════════════════════════════════
strategy_weights:
  trending:
    momentum: 0.6
    mean_reversion: 0.1
    volatility_breakout: 0.3
  ranging:
    momentum: 0.1
    mean_reversion: 0.6
    volatility_breakout: 0.3
  transition:
    momentum: 0.33
    mean_reversion: 0.33
    volatility_breakout: 0.34
regime_detection:
  enabled: true
  adx_regime:
    enabled: true
    trending_threshold: 25
    ranging_threshold: 20

# ═══════════════════════════════════════════════════════════════
# LOGGING
# ═══════════════════════════════════════════════════════════════
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  format: "parquet"
  compression: "snappy"
  partition_by: "date"
  store:
    features: true
    predictions: true
    trades: true
  retention_days: 90

# ═══════════════════════════════════════════════════════════════
# DATA
# ═══════════════════════════════════════════════════════════════
data:
  parquet_path: "v2/data/parquet"
  raw_path: "v2/data/raw"
  processed_path: "v2/data/processed"
